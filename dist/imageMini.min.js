/**
 * @version v0.1.0
 * @link https://github.com/sutras/imageMini#readme
 * @license MIT
 */

!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(n="undefined"!=typeof globalThis?globalThis:n||self).imageMini=t()}(this,(function(){"use strict";var n=["image/png","image/jpeg"],t={"image/jpeg":"jpg","image/png":"png"},e={low:.3,medium:.6,high:.9,super:.95};function o(){}function i(n){return/^data:(.*?);/.exec(n)[1]}function a(n,t){var e=new FileReader;e.onload=function(){t&&t(e.result)},e.readAsDataURL(n)}function r(n){for(var t=i(n),e=atob(n.split(",")[1]),o=new ArrayBuffer(e.length),a=new Uint8Array(o),r=0,f=e.length;r<f;r++)a[r]=e.charCodeAt(r);return new Blob([a],{type:t})}function f(n,t){var e=new Image;e.src=n,e.onload=function(){t&&t(e)}}return o.compressFile=function(t,o,c){"function"==typeof c&&(-1!==n.indexOf(t.type)?a(t,(function(n){f(n,(function(n){var t=function(n,t){var o,a,r,f,c,u=i(n.src),d=n.width,l=n.height;return"function"==typeof t&&(t=t(d,l)),t||(t={}),"string"==typeof(o=t.quality)&&(o=e[o]),("number"!=typeof o||o<0||o>1)&&(o=e.high),r=(a=function(n,t,e,o,i,a,r,f){var c,u,d=n/t;function l(){i&&c>i&&(c=i),o&&c<o&&(c=o)}function g(){f&&u>f&&(u=f),r&&u<r&&(u=r)}return e?(c=e,l(),u=a||c/d,g()):!e&&a?(u=a,g(),c=u*d,l()):(c=n,l(),u=t,g(),i=d*u,f=c/d,l(),g()),[c,u]}(d,l,t.width,t.minWidth,t.maxWidth,t.height,t.minHeight,t.maxHeight))[0],f=a[1],(c=document.createElement("canvas")).width=r,c.height=f,c.getContext("2d").drawImage(n,0,0,r,f),{srcWidth:d,srcHeight:l,width:r,height:f,dataURL:c.toDataURL(u,o)}}(n,o);c(r(t.dataURL),t)}))})):c(t))},o.download=function(n,e,o){function f(n){var t=document.createElement("a");t.download=e,t.href=n,t.onclick=function(){o&&o()},t.click()}var c=n instanceof Blob,u=t[c?n.type:i(n)];e=(e||"download")+"."+u,window.navigator.msSaveBlob?(c||(n=r(n)),window.navigator.msSaveBlob(n,e)):c?a(n,(function(n){f(n)})):f(n)},o.allowed=n,o.mapMimeToExt=t,o.blobToDataURL=a,o.blobToImage=function(n,t){a(n,(function(n){f(n,t)}))},o.dataURLtoBlob=r,o.dataURLtoImage=f,o}));